<!DOCTYPE html>
<html>
	<head>
		<title>JZT</title>
		<style type="text/css">
			#jzt {
				position: relative;
			}
		</style>
	</head>
	<body>
		
		<header>
			<!--<h1>Mark's Test Thing</h1>-->
		</header>
		
		<canvas id="jzt" style="border: 1px solid blue;" width="640" height="480"></canvas>

		<div id="toolbox">

			<label><input type="radio" name="activeTemplate" value="" />Nothing</label>
			<label><input type="radio" name="activeTemplate" value="Wall" />Wall</label>
			<label><input type="radio" name="activeTemplate" value="SolidWall" />Solid Wall</label>
			<label><input type="radio" name="activeTemplate" value="LineWall" />Line</label>
			<label><input type="radio" name="activeTemplate" value="InvisibleWall" />Invisible Wall</label>
			<label><input type="radio" name="activeTemplate" value="BreakableWall" />Breakable Wall</label>
			<label><input type="radio" name="activeTemplate" value="Boulder" />Boulder</label>
			<label><input type="radio" name="activeTemplate" value="Water" />Water</label>
			<label><input type="radio" name="activeTemplate" value="Forest" />Forest</label>

			<label><input type="radio" name="activeTemplate" value="Lion" />Lion</label>
			<label><input type="radio" name="activeTemplate" value="Centipede" />Centipede</label>

			<button id="save-game">Save</button>

			<label>Boards
				<select id="board-selector">
					<option value='jzt.newboard'>Create New Board</option>
				</select>
			</label>




		</div>
		
		<script type="text/javascript" src="script/jzt.js"></script>
		<script type="text/javascript" src="script/board.js"></script>
		<script type="text/javascript" src="script/input.js"></script>
		<script type="text/javascript" src="script/basic.js"></script>
		<script type="text/javascript" src="script/script.js"></script>
		<script type="text/javascript" src="script/parser.js"></script>
		<script type="text/javascript" src="script/jztscript.js"></script>
		<script type="text/javascript" src="script/commands.js"></script>
		<script type="text/javascript" src="script/graphics.js"></script>
		<script type="text/javascript" src="script/things.js"></script>
		<script type="text/javascript" src="script/editor.js"></script>
		<script type="text/javascript">

			var boardSelector = document.getElementById('board-selector');
			var editor = undefined;

			function onToolSelected(event) {
				if(event.target.value) {
					editor.setActiveTool({serializationType: event.target.value});
				}
				else {
					editor.setActiveTool(undefined);
				}
			};

			function onBoardSelected(event) {
				if(event.target.value === 'jzt.newboard') {
					var newName = window.prompt('Please enter a board name.', 'Untitled');
					if(newName) {
						newName = editor.getUniqueBoardName(newName);
						editor.addBoard(newName, 40, 15);
					}
				}
				else {
					editor.switchBoard(event.target.value);
				}
			};

			function onBoardAdded(boardName) {
				boardSelector.options[boardSelector.options.length] = new Option(boardName, boardName);
			};

			function onBoardRemoved(boardName) {

			};

			function onBoardChanged(boardName) {
				boardSelector.value = boardName;
			};

			function saveGame(event) {
				editor.save();
				alert('Game Saved!');
			}

			var tools = document.getElementsByName('activeTemplate');
			for( var index = 0; index < tools.length; index++ ) {
        		tools[index].addEventListener('change', onToolSelected, false);
    		}	

    		var saveButton = document.getElementById('save-game');
    		saveButton.addEventListener('click', saveGame, false);

			var canvas = document.getElementById('jzt');
			var callbacks = {
				addBoard: onBoardAdded,
				removeBoard: onBoardRemoved,
				changeBoard: onBoardChanged
			};
			editor = new jzt.Editor(canvas, callbacks);

			boardSelector.addEventListener('change', onBoardSelected, false);


		</script>
		
	</body>
</html>